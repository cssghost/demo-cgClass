cgClass.AddClass("Autocomplete",{init:function(j){var i=this,c=$.extend({wrap:$(".Js-auto-frame"),template:null,autoList:".Js-auto-list",autoItem:".Js-auto-item",autoText:".Js-auto-text",autoBtn:$(".Js-auto-btn"),hasBtn:true,hoverClass:"selected",init:function(l){},createSearchList:function(l,n,m){},action:function(l,m){}},j),k=c.wrap,d=k.find(c.autoList),g=k.find(c.autoText),f=k.find(c.autoBtn),e=c.template||'<li class="auto-item Js-auto-item hide-row"><a href="javascript:void(0)" title="#{title}">#{title}</a></li>',h={back:8,enter:13,escape:27,up:38,down:40,array:[13,27,38,40]},a=[],b=[];i.wrap=k;i.list=d;i.text=g;i.btn=f;i.itemTemp=e;i.outParam=i.applyMethods(i,{oWrap:k,oList:d,oText:g,oBtn:f,returnText:i.returnText,addItem:i.addItem,showList:i.showList,closeList:i.closeList});k.on("mouseenter",c.autoItem,function(){$(this).addClass(c.hoverClass)}).on("mouseleave",c.autoItem,function(){$(this).removeClass(c.hoverClass)}).on("click",c.autoItem,function(){i.closeList();if(typeof(c.action)=="function"){c.action(i.outParam,$.trim($(this).children().attr("title")),$(this))}i.returnText($(this).children().attr("title"))}).on("keyup",c.autoText,function(o){var p=o.keyCode;a.push((new Date()).getTime());var n=a[(a.length-1)];var q="";if($.inArray(p,h.array)!=-1){q=$.trim(g.val());if(d.is(":hidden")&&d.children(c.autoItem).length){i.showList()}var m=d.children(c.autoItem),l=m.filter("."+c.hoverClass);switch(p){case h.up:if(l.length){l.removeClass(c.hoverClass).prev().addClass(c.hoverClass)}else{m.last().addClass(c.hoverClass)}break;case h.down:if(l.length){l.removeClass(c.hoverClass).next().addClass(c.hoverClass)}else{m.first().addClass(c.hoverClass)}break;case h.enter:d.hide();if(typeof(c.action)=="function"){if(l.length){l.click()}else{c.action(i.outParam,$.trim(g.val()),l)}}break;default:break}}else{setTimeout(function(){q=$.trim(g.val());if(n==a[(a.length-1)]&&q!=""){c.createSearchList(i.outParam,q)}else{if(q==""){i.closeList()}}},300)}}).on("keydown",c.autoText,function(l){var m=l.keyCode;if(m==h.back&&$.trim($(this).val())==""&&d.is(":visible")){i.closeList()}}).on("focus",c.autoText,function(){if($.trim($(this).val())!=""&&d.children().length&&d.is(":hidden")){i.showList()}});if(c.hasBtn){c.autoBtn.on("click",function(){i.closeList();if(typeof(c.action)=="function"){c.action(i.outParam,$.trim(g.val()))}})}if(typeof c.init=="function"){c.init(i.outParam)}},returnText:function(a){this.text.val($.trim(a))},addItem:function(b){var a=this;a.list.empty();if(b.constructor===Array&&b.length){$.each(b,function(c,d){a.list.append($.getFromTemplate(a.itemTemp,d))});a.showList()}else{a.closeList()}},showList:function(){var a=this;a.list.slideDown("fast","linear",function(){$(document).one("click",function(){a.list.hide()})})},closeList:function(){this.list.hide()}});